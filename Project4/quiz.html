<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel='stylesheet' type='text/css' href='style.css'>
    <link href="https://fonts.googleapis.com/css?family=Kanit:400,700,900" rel="stylesheet">
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
    <link rel="stylesheet" href="jquery-ui.min.css">
</head>

<body>
    <div class="mainwrap">
        <main>
           
            <div class="quizgrid">
               
<div class="movie movie1">
    <div class="wrap">
        <div class="flex">
            <div class="header">
                <div class="logo">
                    <h2>DMDb</h2>
                </div>
                <div class="wrap">
                    <div class="flex">

                        <div class="answercont">
                            <div class="answerslot movie1answer1slot">

                            </div>
                        </div>
                        <div class="year">
                            <h3>(</h3>
                            <div class="answercont">
                                <div class="answerslot movie1answer2slot">
                                    <h4></h4>
                                </div>
                            </div>
                            <h3>)</h3>
                        </div>
                        <div class="star">
                            <i class="fas fa-star"></i>
                        </div>

                    </div>
                </div>
            </div>
            <div class="answers">
                <div class="wrap">
                    <div class="flex">
                        <div class="imgcont">
                            <img src="" alt="Movie Poster" class="poster1">
                        </div>
                        <div class="inneranswers">
                            <h3>Director:</h3>
                            <div class="answercont">
                                <div class="answerslot movie1answer3slot">
                                    <h4></h4>
                                </div>
                            </div>
                            <h3>Runtime:</h3>
                            <div class="answercont">
                                <div class="answerslot movie1answer4slot">
                                    <h4></h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="movie movie2">
    <div class="wrap">
        <div class="flex">
            <div class="header">
                <div class="logo">
                    <h2>DMDb</h2>
                </div>
                <div class="wrap">
                    <div class="flex">

                        <div class="answercont">
                            <div class="answerslot movie2answer1slot">

                            </div>
                        </div>
                        <div class="year">
                            <h3>(</h3>
                            <div class="answercont">
                                <div class="answerslot movie2answer2slot">
                                    <h4></h4>
                                </div>
                            </div>
                            <h3>)</h3>
                        </div>
                        <div class="star">
                            <i class="fas fa-star"></i>
                        </div>

                    </div>
                </div>
            </div>
            <div class="answers">
                <div class="wrap">
                    <div class="flex">
                        <div class="imgcont">
                            <img src="" alt="Movie Poster" class="poster2">
                        </div>
                        <div class="inneranswers">
                            <h3>Director:</h3>
                            <div class="answercont">
                                <div class="answerslot movie2answer3slot">
                                    <h4></h4>
                                </div>
                            </div>
                            <h3>Runtime:</h3>
                            <div class="answercont">
                                <div class="answerslot movie2answer4slot">
                                    <h4></h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="movie movie3">
    <div class="wrap">
        <div class="flex">
            <div class="header">
                <div class="logo">
                    <h2>DMDb</h2>
                </div>
                <div class="wrap">
                    <div class="flex">

                        <div class="answercont">
                            <div class="answerslot movie3answer1slot">

                            </div>
                        </div>
                        <div class="year">
                            <h3>(</h3>
                            <div class="answercont">
                                <div class="answerslot movie3answer2slot">
                                </div>
                            </div>
                            <h3>)</h3>
                        </div>
                        <div class="star">
                            <i class="fas fa-star"></i>
                        </div>

                    </div>
                </div>
            </div>
            <div class="answers">
                <div class="wrap">
                    <div class="flex">
                        <div class="imgcont">
                            <img src="" alt="Movie Poster" class="poster3">
                        </div>
                        <div class="inneranswers">
                            <h3>Director:</h3>
                            <div class="answercont">
                                <div class="answerslot movie3answer3slot">
                                    <h4></h4>
                                </div>
                            </div>
                            <h3>Runtime:</h3>
                            <div class="answercont">
                                <div class="answerslot movie3answer4slot">
                                    <h4></h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
                <div class="options">
                    <div class="wrap">

<div class="flex">
<h4 class="title2"></h4>
<h4 class="year2"></h4>
<h4 class="runtime2"></h4>
<h4 class="title3"></h4>
<h4 class="runtime1"></h4>
<h4 class="director2"></h4>
<h4 class="year3"></h4>
<h4 class="director1"></h4>
<h4 class="year1"></h4>
<h4 class="director3"></h4>
<h4 class="runtime3"></h4>
<h4 class="title1"></h4>
</div>
</div>
</div>
<h1>Can you put these in the right order for me, buddy?</h1>
<button class"reload">Play Again?</button>
            </div>
        </main>
    </div>
    <!-- <footer>

    </footer> -->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="external/jquery/jquery.js"></script>
<script src="jquery-ui.min.js"></script>

    <script>

            const myApp = {};

            $("h4").draggable({
                snap: ".answercont",
                snapMode: "inner",
                snapTolerance: 30,
                revert: "invalid"
            });
            $(".answerslot").droppable({
                accept: "",
                drop: function (event, ui) {
                    $(this)
                        .addClass("correct")
                }
            });


           $(".movie1answer1slot").droppable({
                accept: ".title1",
            });

            $(".movie1answer2slot").droppable({
                accept: ".year1",
            });

            $(".movie1answer3slot").droppable({
                accept: ".director1",
            });

            $(".movie1answer4slot").droppable({
                accept: ".runtime1",
            });

            $(".movie2answer1slot").droppable({
                accept: ".title2",
            });

            $(".movie2answer2slot").droppable({
                accept: ".year2",
            });

            $(".movie2answer3slot").droppable({
                accept: ".director2",
            });

            $(".movie2answer4slot").droppable({
                accept: ".runtime2",
            });

            $(".movie3answer1slot").droppable({
                accept: ".title3",
            });

            $(".movie3answer2slot").droppable({
                accept: ".year3",
            });

            $(".movie3answer3slot").droppable({
                accept: ".director3",
            });

            $(".movie3answer4slot").droppable({
                accept: ".runtime3",
            });


    //function call to make typing happen will have to place into window init function
    sort('letter1', 100);
    sort('letter2', 8000);
    sort('letter3', 15000);

    //functions

    //number 3 radomizer for class naming

    const randomName = function () {

        return Math.floor(Math.random() * 3);
    }

    //our typing function

    //function for copying letters in paragragh to array and starting the typing method call
    function sort(className, delay) {
        let letters1 = $(`.${className}`).text().split('');
        $(`.${className}`).text('');
        setTimeout(typing, delay, `${className}`, letters1);
    }

    //function to star pushing characters to be typed
    function typing(para, letters) {

        function type(input, inputArray) {

            $(`.${input}`).append(`<span>${inputArray[index]}`);
            index = index + 1;

            if (index == inputArray.length) {
                //stop call of setInterval Method
                clearInterval(interval);
            }
        }

        //variables for tracking
        const counter = 0;
        var index;

        index = counter;
        var interval = setInterval(type, 60, para, letters);
    }

    //button presses for start button and replay button

    $('.start').on('click', function () {
        window.location = 'quiz.html';
    });

    $('.reload').on('click', function () {
        window.location.reload();
    });


    //Quiz page js actions

    //functions to create a 7 digit number to add to needed prefix for IMDB api
    //Need to create an array that could have 0's preceeding a number up to 7 sig. digits

    //pick a random number between 0 - 9

    const random = function () {
        let random = Math.floor(Math.random() * 9);
        return random;
    }

    //function for creating array of 7 indexes with 7 random numbers generated
    const numGen = function () {
        let numberInput = [];
        for (let i = 0; i < 7; i++) {
            numberInput.push(random());
        }
        return numberInput;
    }

    //function for creating 7 digit string to put into imdb database
    const inputString = function () {
        let stringInput = '';

        numGen().forEach(function (data) {
            stringInput = stringInput + data;
        });

        return stringInput;
    }


    for (let i = 0; i < 4; i++) {
        movieCall();

        //function for calling api to get movie info from random 7 digit string
        function movieCall() {

            return $.ajax({
                method: 'GET',
                url: 'http://www.omdbapi.com/',
                dataType: 'jsonp',
                data: {
                    //apikey: '9aa522e',
                    apikey: 'e4a75d0b',
                    i: `tt${inputString()}`,
                }
            }).then(function (res) {
                //check output and print to screen
                if (responseCheck(res) == 'True') {
                    ifPosterExist(res);

                } else {
                    movieCall();
                };

            });

        }

        //functions to test api data

        const responseCheck = function (data) {
            return data.Response;
        }


        const ifPosterExist = function (data) {
            if (data.Poster == "N/A" || data.Type !== "movie" || data.Language !== "English" || data.Title == "N/A" || data.Director == "N/A" || data.Year == "N/A") {
                movieCall();
            } else {

                //adds poster to container
                $(`.poster${i}`).attr('src', `${data.Poster}`);

                //add title
                $(`.title${i}`).append(`<h4 class="title${i}">${data.Title}</h4>`);

                //add director
                $(`.director${i}`).append(`<h4 class="director${i}">${data.Director}</h4>`);

                //add year
                $(`.year${i}`).append(`<h4 class="year${i}">${data.Year}</h4>`);

                //add runtime
                $(`.runtime${i}`).append(`<h4 class="runtime${i}">${data.Runtime}</h4>`);


            };
        }

    }

    </script>
</body>

</html>